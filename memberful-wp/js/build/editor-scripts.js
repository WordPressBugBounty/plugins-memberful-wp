(()=>{"use strict";const e=window.wp.components,i=window.wp.i18n,l=window.wp.compose,t=window.wp.hooks,s=window.wp.blockEditor,n=window.ReactJSXRuntime,o=window?.memberful_wp_block_editor?.options?.memberful_subscriptions||[],r=window?.memberful_wp_block_editor?.block_visibility_excluded_blocks||[];(0,t.addFilter)("blocks.registerBlockType","memberful/block-visibility",(e,i)=>(void 0!==e.attributes&&(r.includes(i)||(e.attributes=Object.assign(e.attributes,{memberful_visibility:{type:"string",enum:["none","logged_in","specific"],default:"none"},memberful_visibility_hide:{type:"boolean",default:!1},memberful_visibility_plans:{type:"array",default:[]}}))),e));const b=l=>{const{attributes:t,setAttributes:s}=l,{memberful_visibility:r,memberful_visibility_hide:b,memberful_visibility_plans:m}=t;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(e.SelectControl,{label:b?(0,i.__)("Hide content from:","memberful"):(0,i.__)("Show content to:","memberful"),value:r,onChange:e=>{"none"!==e&&e||s({memberful_visibility_hide:!1}),s({memberful_visibility:e,memberful_visibility_plans:[]})},options:[{value:"none",label:(0,i.__)("All users (Default)","memberful")},{value:"logged_in",label:(0,i.__)("All logged-in members","memberful")},{value:"specific",label:(0,i.__)("Specific membership plan","memberful")}]}),"specific"===r&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{className:"components-base-control__help",style:{color:"rgb(117, 117, 117)",fontSize:"12px"},children:(0,i.__)("Applies to members with an active subscription to at least one of the following plans:","memberful")}),Object.entries(o).map(([i,l])=>(0,n.jsx)(e.CheckboxControl,{label:l.name,checked:m.includes(i),onChange:e=>((e,i)=>{s(i?{memberful_visibility_plans:[...m,e]}:{memberful_visibility_plans:m.filter(i=>i!==e)})})(i,e)},i)),0===m.length&&(0,n.jsx)(e.Notice,{status:"error",isDismissible:!1,children:(0,i.__)("Please select at least one plan.","memberful")})]}),"none"!==r&&(0,n.jsx)(e.ToggleControl,{label:(0,i.__)("Hide when the above conditions are met","memberful"),checked:b,onChange:()=>s({memberful_visibility_hide:!b})})]})},m=(0,l.createHigherOrderComponent)(l=>t=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l,{...t},"edit"),t.isSelected&&!r.includes(t.name)&&(0,n.jsx)(s.InspectorControls,{children:(0,n.jsx)(e.PanelBody,{title:(0,i.__)("Memberful Visibility","memberful"),initialOpen:!1,children:b(t)})})]}),"MemberfulVisibilityControls");(0,t.addFilter)("editor.BlockEdit","memberful/block-visibility",m)})();